Using device: mps
Loading dataset...
Scanning 2 videos...
Scanning videos: 100%|████████████████████████████████████████████████████████████████████████| 2/2 [00:00<00:00, 153.80it/s]
Total frames available: 125048
Train set: 106291 frames
Test set: 18757 frames
Creating VAE model...
VAE model created with 129,467,600 parameters
Starting training...
Epoch 1/100 [Train]:   0%|                                                                         | 0/13287 [00:00<?, ?it/s]/Users/tsuberim/Projects/open-oasis/.venv/lib/python3.13/site-packages/torch/utils/data/dataloader.py:683: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
Epoch 1/100 [Train]:   0%|                         | 8/13287 [00:17<8:15:52,  2.24s/it, loss=1.0002, recon=0.2254, kl=0.7748]
Traceback (most recent call last):
  File "/Users/tsuberim/Projects/open-oasis/train_vae.py", line 429, in <module>
  File "/Users/tsuberim/Projects/open-oasis/train_vae.py", line 415, in main
        train_loader=train_loader,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<8 lines>...
    print("Training completed!")
    ^
  File "/Users/tsuberim/Projects/open-oasis/train_vae.py", line 155, in train_vae
    optimizer.step()
    ~~~~~~~~~~~~~~^^
  File "/Users/tsuberim/Projects/open-oasis/.venv/lib/python3.13/site-packages/torch/optim/lr_scheduler.py", line 124, in wrapper
    return func.__get__(opt, opt.__class__)(*args, **kwargs)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/Users/tsuberim/Projects/open-oasis/.venv/lib/python3.13/site-packages/torch/optim/optimizer.py", line 485, in wrapper
    out = func(*args, **kwargs)
  File "/Users/tsuberim/Projects/open-oasis/.venv/lib/python3.13/site-packages/torch/optim/optimizer.py", line 79, in _use_grad
    ret = func(self, *args, **kwargs)
  File "/Users/tsuberim/Projects/open-oasis/.venv/lib/python3.13/site-packages/torch/optim/adam.py", line 246, in step
    adam(
    ~~~~^
        params_with_grad,
        ^^^^^^^^^^^^^^^^^
    ...<19 lines>...
        decoupled_weight_decay=group["decoupled_weight_decay"],
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/tsuberim/Projects/open-oasis/.venv/lib/python3.13/site-packages/torch/optim/optimizer.py", line 147, in maybe_fallback
    return func(*args, **kwargs)
  File "/Users/tsuberim/Projects/open-oasis/.venv/lib/python3.13/site-packages/torch/optim/adam.py", line 933, in adam
    func(
    ~~~~^
        params,
        ^^^^^^^
    ...<17 lines>...
        decoupled_weight_decay=decoupled_weight_decay,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/tsuberim/Projects/open-oasis/.venv/lib/python3.13/site-packages/torch/optim/adam.py", line 405, in _single_tensor_adam
    param.mul_(1 - lr * weight_decay)
    ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
